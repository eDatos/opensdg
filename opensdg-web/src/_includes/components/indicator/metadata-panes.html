<div class="tab-content">
    {% if site.metadata_tabs %}
        {% for tab in site.metadata_tabs %}
            {% comment %} @deprecated start {% endcomment %}
            {% assign tab_key = tab[0] %}
            {% assign tab_obj = tab[1] %}
            {% comment %} @deprecated end {% endcomment %}
            {% if tab.scope %}
                {% assign tab_key = tab.scope %}
                {% assign tab_obj = tab %}
            {% endif %}
            {% assign tab_description = tab_obj.description | default: tab_obj.blurb %}
            {% assign tab_include = 'components/indicator/metadata.html' %}
            {% if tab_key == 'sources' %}
                {% assign tab_include = 'components/indicator/sources.html' %}
            {% endif %}
            <div role="tabpanel" class="tab-pane {% if forloop.first %}active{% endif %}" id="{{ tab_key }}">
                <article>
                    {% if tab_description %}
                        {{ tab_description | t | markdownify }}
                    {% endif %}
                    {% include {{ tab_include }} scope=tab_key %}
                </article>
            </div>
        {% endfor %}
    {% else %}
        {% include components/indicator/metadata-panes-default.html %}
    {% endif %}
    
    {% if page.indicator.reporting_status != 'notstarted' %}
        <!-- <script>
            function openMap(slug) {
                document.getElementById(`chart-wrapper-${slug}`).style.display = "none";
                document.getElementById(`map-wrapper-${slug}`).style.display = "block";
            }

            function openChart(slug) {
                document.getElementById(`chart-wrapper-${slug}`).style.display = "block";
                document.getElementById(`map-wrapper-${slug}`).style.display = "none";
            }
        </script> -->
        {% assign sorted_indicators = page.indicators | where: 'target_id', page.indicator.number | sort: 'sort_order' %}
        {% for s in sorted_indicators%}
            <div class="tab-pane {% if forloop.first %}active{% endif %}" id="subindicator{{ s.number | replace: '.', '' }}" role="tabpanel">
                <!-- <div class="btn-group" role="group" aria-label="Selección mapa o gráfico">
                    <button onclick="openChart('{{ s.slug }}')" type="button" class="btn btn-secondary">Gráfico</button>
                    <button onclick="openMap('{{ s.slug }}')" type="button" class="btn btn-secondary">Mapa</button>
                </div> -->

                <div class="mb-2 text-center"><h3><b>{{ s.graph_title | t }}</b></h3></div>

                <div id="chart-wrapper-{{ s.slug }}" class="chart">
                    {% include components/subindicator/subindicator-chart.html scope=s %}
                </div>
                {% if s.show_map %}
                <div id="map-wrapper-{{ s.slug }}" class="map">
                    {% include components/subindicator/subindicator-map.html scope=s %}
                </div>
                {% endif %}
                
                <div class="metadata">
                    {% include components/subindicator/subindicator-metadata.html scope=s %}
                </div>
            </div>
        {% endfor %}
    {% endif %}

    {% if site.environment == 'staging' %}
        <div class="tab-pane" id="edit" role="tabpanel">
            {% include components/indicator/edit-buttons.html %}
        </div>
    {% endif %}
</div>
